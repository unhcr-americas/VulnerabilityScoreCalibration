# WARNING - Generated by {fusen} from /dev/package_functions.Rmd: do not edit by hand

# usethis::use_rmarkdown_template(
#   template_name = "quadratic_report",
#   template_dir = NULL,
#   template_description = "Results from Quadratic Voting",
#   template_create_dir = TRUE
# )
#' Generate Report From Quadratic Voting 
#'  
#' @param folder folder within your project where to put the generated report. 
#'              Folder will be created if it does not exist
#' @param data path to data collected through kobotoolbox
#' @param form form used to collected through kobotoolbox quadratic survey
#' 
#' @importFrom unhcrdown pptx_slides
#' @importFrom dplyr filter select pull
#' @importFrom rmarkdown render
#' @importFrom here here
#' 
#' @return nothing the file for the report is generated
#' 
#' @export 
#'

#' @examples
#' 
#' ## Example -> the report will be saved in the same folder...
#' # quadratic_report(data = "data.xlsx",
#' #                  form = "form.xlsx",
#' #                  folder = "data-raw") 
quadratic_report <- function(data = "data.xlsx",
                             form = "form.xlsx",
                             folder = "data-raw") {
  
  ## Create the outfolder if it does not exist
  output_dir <- paste0(getwd(),"/",folder)
  if (!dir.exists(output_dir)) { stop("you did not provided the name of an existing folder within you project")}

  rmarkdown::render(
    system.file("rmarkdown/templates/quadratic_report/skeleton/skeleton.Rmd", package = "unhcrdatapackage"),
    output_file = here::here(folder, paste0('quadratic_report-', country_asylum_iso3c, '-', year, '.pptx') ),
    params = list( folder=  folder,
                   data = data,
                  form= form)  )
}

