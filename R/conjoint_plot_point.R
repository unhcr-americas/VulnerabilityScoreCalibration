# WARNING - Generated by {fusen} from dev/function_documentation.Rmd: do not edit by hand

#' conjoint_plot_point
#' 
#' Plot results per dimension - Marginal Means
#' 
#' @param .x A list or atomic vector.
#' @import ggplot2
#' @importFrom unhcrthemes theme_unhcr
#' @importFrom stringr str_wrap
#' 
#' @return a ggplot2 object
#' @export
#' @examples
#'
#' kobodata <-  system.file("data-demo/conjoint_data.xlsx", package = "VulnerabilityScoreCalibration")
#' koboform <-  system.file("data-demo/conjoint_form.xlsx", package = "VulnerabilityScoreCalibration") 
#'
#' cj <- conjoint_review(kobodata, koboform)
#'  
#' conjoint_plot_point( as.data.frame(cj[["cjdata"]][1,][["margins"]])) + 
#'   ggplot2::labs( subtitle = "Margins)")
#'
#' conjoint_plot_point( as.data.frame(cj[["cjdata"]][1,][["amces"]])) + 
#'   ggplot2::labs( subtitle = "Average Marginal Component Effects (AMCEs)")
#'
#' conjoint_plot_point( as.data.frame(cj[["cjdata"]][1,][["importance"]])) + 
#'   ggplot2::labs( subtitle = "Importance")

conjoint_plot_point <- function(.x) {
    ggplot(.x,
           aes(estimate, 
               level, 
               xmin = lower, 
               xmax = upper)) +
      geom_pointrange() +
      scale_y_discrete(labels = \(x) stringr::str_wrap(x, 80)) +
      facet_wrap(vars(feature), ncol = 1, 
                 scales = "free_y") +
      labs(
        caption = glue::glue(
          "Las l\u00edneas alado de los puntos representan el intervalo de confianza.",
          "(Entre m\u00e1s corta la l\u00ednea, hubo m\u00e1s acuerdo entre participantes.)",
          .sep = "\n"
        ),
        x = NULL,
        y = NULL
      ) +
      unhcrthemes::theme_unhcr() +
      theme(plot.caption = element_text(hjust = 1))
  }
