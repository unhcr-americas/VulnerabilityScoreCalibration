# WARNING - Generated by {fusen} from /dev/package_functions.Rmd: do not edit by hand

#' conjoint_walk 
#' 
#' Print out a summary from the conjoint analysis  
#' 
#'   *  Marginal Means
#' 
#'   *  Average Marginal Component Effects (AMCEs)
#' 
#'   *  Average Marginal Component Effects (AMCEs)
#' 
#'   *  Importance Weights
#' 
#' @param dim
#' @param margins
#' @param amces
#' @param importance
#' 
#' @importFrom glue glue
#' 
#' @return
#' 
#' @export
#' @examples
#' kobodata <-  system.file("data-demo/conjoint_data.xlsx", package = "VulnerabilityScoreCalibration")
#' koboform <-  system.file("data-demo/conjoint_form.xlsx", package = "VulnerabilityScoreCalibration") 
#' 
#' cj <- conjoint_review(kobodata, koboform) 
#' cjdata <- cj[["cjdata"]]
#' ## Get a summary of all dimensions
#' purrr::pwalk(cjdata, conjoint_walk)
#' 
#' ## Save a csv extract of the weights
#' # purrr::walk2(cjdata$dim, cjdata$amces, ~write_csv(.y, fs::path(.x, ext = "csv")))
#' 
#' all <- purrr::walk2(cjdata$amces,  ~cbind())
#' 
#' all <-purrr::pwalk(cjdata$amces, rbind)
#' all2 <- bind_rows(cjdata$amces, .id = "column_label")
#' 
#' 
#' 
conjoint_walk <- function(dim, margins, amces, importance, ...) {
    cat("---\n\n")
    cat(glue::glue("{dim}\n\n"))
    cat("---\n\n")
    cat("## Average Marginal Component Effects (AMCEs) - Bar \n\n")
    print(conjoint_plot_bar(amces) + labs(title = dim, subtitle = "Average Marginal Component Effects (AMCEs)"))
    cat("\n\n")
    cat("## Average Marginal Component Effects (AMCEs) - Point \n\n")
    print( conjoint_plot_point(amces) + labs(title = dim, subtitle = "Average Marginal Component Effects (AMCEs)") )
    cat("\n\n")
    cat("## Marginal Means\n\n")
    print(conjoint_plot_point(margins) + labs(title = dim, subtitle = "Marginal Means"))
    cat("\n\n")
    cat("## Importance Weights\n\n")
    print(conjoint_plot_point(importance) + 
            scale_x_continuous(labels = scales::label_percent()) + 
            labs(title = dim, subtitle = "Importance Weights")  )
    cat("\n\n")
  }
