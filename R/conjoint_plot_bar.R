# WARNING - Generated by {fusen} from /dev/package_functions.Rmd: do not edit by hand

#' conjoint_plot_bar
#' 
#' Plot results per dimension - Average Marginal Component Effects (AMCEs)
#' 
#' @param .x
#' @return gggplot2 graph
#' @import ggplot2
#' @importFrom unhcrthemes theme_unhcr
#' @importFrom stringr str_wrap
#' 
#' @return
#' 
#' @export
#' @examples
#' 
#' kobodata <-  system.file("data-demo/conjoint_data.xlsx", package = "VulnerabilityScoreCalibration")
#' koboform <-  system.file("data-demo/conjoint_form.xlsx", package = "VulnerabilityScoreCalibration") 
#' 
#' cj <- conjoint_review(kobodata, koboform)
#'  
#' ## Plot AMCES as bar for dimension 2
#' conjoint_plot_bar( as.data.frame(cj[["cjdata"]][2,][["amces"]])) + 
#'   ggplot2::labs( subtitle = "Average Marginal Component Effects (AMCEs)")
#' 
#' ## Plot importance as bar for dimension 2
#' conjoint_plot_bar( as.data.frame(cj[["cjdata"]][2,][["importance"]])) + 
#'   ggplot2::labs( subtitle = "Importance")
conjoint_plot_bar <- function(.x) {
    ggplot(.x, aes(horizontal,
                   level, 
                   label = round(horizontal, 2))) +
      geom_col(fill = "#0072BC") +
      geom_label() +
      scale_y_discrete(labels = \(x) stringr::str_wrap(x, 90)) +
      facet_wrap(vars(feature), ncol = 1, scales = "free_y") +
      unhcrthemes::theme_unhcr() +
      theme(plot.caption = element_text(hjust = 1))
  }
