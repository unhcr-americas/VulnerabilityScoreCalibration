---
title: "Quadratic Voting Results"
subtitle: " " 
date: "`r format(Sys.Date(),  '%d %B %Y')`"
output:
  unhcrdown::pptx_slides
params:
  folder: "data-raw"
  data: "data.xlsx"
  form: "form.xlsx"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	fig.align = "center",
	fig.asp = 0.618,
	fig.retina = 2,
	fig.width = 9,
	message = FALSE,
	warning = FALSE,
	collapse = FALSE,
	comment = "#>",
	dev = "ragg_png",
	out.width = "90%"
)
options(scipen = 999) # turn-off scientific notation like 1e+48
set.seed(1)
extrafont::loadfonts(quiet=TRUE)

library("tidyverse")
library("officedown")
library("unhcrthemes")
library("ggplot2")
library("rvg")
library("tidyverse")
library("scales")
library("lubridate")
library("pak")

##  make sure to get last version 
# if ( packageVersion("VulnerabilityScoreCalibration") != "0.0.1"){pak::pkg_install("unhcr-americas/VulnerabilityScoreCalibration")}
library("VulnerabilityScoreCalibration")
# turn off the automatic use of showtext functionality, so that the dml function can works properly
showtext::showtext_auto(FALSE) 
```

```{r  }
## The 2 lines below are for the demo - please uncomment the 2 below 
# kobodata <-  system.file("data-demo/quadra_data.xlsx", package = "VulnerabilityScoreCalibration")
# koboform <-  system.file("data-demo/quadra_form.xlsx", package = "VulnerabilityScoreCalibration")

# and comment those one if you want the demo..
kobodata <- here::here(params$folder, params$data)
koboform <- here::here(params$folder, params$form)
```


```{r  }
## Run the process
result <- quadratic_review(kobodata, koboform)
```


## Intro

Quadratic voting to help prioritization: When everything is important, what is more important?

Results ->  

 1. __Prioritized topics__  : Identify quickly the most important topic
 
 2. __Vote dispersion__: Review how opinionated people are  
 
 3. __Individual choices__: identify people with different opinion patterns  
 

---
 
```{r ph=officer::ph_location_fullsize()}
#```{r layout='Title and Content', ph=officer::ph_location_type(type="body")}
## here you can paste selected charts from the initial exploration phase...
result[["topic_prioritisation"]] -> p
dml(ggobj = p, fonts = list(serif = 'Lato'))
```



---
 
```{r ph=officer::ph_location_fullsize()}
#```{r layout='Title and Content', ph=officer::ph_location_type(type="body")}
result[["vote_dispersion"]] -> p
dml(ggobj = p, fonts = list(serif = 'Lato'))
```



--- 

```{r ph=officer::ph_location_fullsize()}
#```{r layout='Title and Content', ph=officer::ph_location_type(type="body")}
result[["individual_prioritisation"]] -> p
dml(ggobj = p, fonts = list(serif = 'Lato'))
```
